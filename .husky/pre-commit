NC='\033[0m'
BGreen='\033[30;42m'
BIPink='\033[1;35m'
BIBlue='\033[1;34m'

# Identificando arquivos staged com extensões relevantes
STAGED_FILES=$(git diff --cached --name-only --diff-filter=ACM | grep -E "\.(js|jsx|ts|tsx|css|scss)$") || true

# Formatando e verificando cada arquivo alterado
for FILE in $STAGED_FILES; do
    echo -e "${BIPink}🌸 Formatando ${FILE}... ${NC}"
    yarn prettier --write "${FILE}" > /dev/null >&1
    git add "${FILE}"

    echo -e "${BIBlue}🔍 Verificando ${FILE} com ESLint... ${NC}"
    yarn eslint "${FILE}" --fix --max-warnings=0 > /dev/null >&1
    git add "${FILE}"
done

echo -e "\n\n${BGreen}                                   ${NC}"
echo -e "${BGreen} Tudo certo! Push autorizado 👮 🎉 ${NC}"
echo -e "${BGreen}                                   ${NC}\n\n"
exit 0